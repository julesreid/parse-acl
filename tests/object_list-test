#!/bin/bash

PARSEACL=../parse-acl

echo -n Test 1...
cat <<EOF > x-result-test
All_Devices
	10.1.1.1
	10.2.1.1
	10.2.1.2
	10.3.1.1
	10.3.1.2
	10.3.1.3
	192.168.1.10
	192.168.1.11
	192.168.1.12
All_Endpoints
	10.0.0.0/8
	172.16.0.0/12
	192.168.0.0/16
All_Internal
	10.0.0.0/8
	172.16.0.0/12
	192.168.0.0/16
Branch_A
	10.1.1.1
Branch_B
	10.2.1.1
	10.2.1.2
Branch_C
	10.3.1.1
	10.3.1.2
	10.3.1.3
Branches
	10.1.1.1
	10.2.1.1
	10.2.1.2
	10.3.1.1
	10.3.1.2
	10.3.1.3
Complete_Network
	10.0.0.0/8
	10.1.1.1
	10.2.1.1
	10.2.1.2
	10.3.1.1
	10.3.1.2
	10.3.1.3
	172.16.0.0/12
	192.168.0.0/16
	192.168.1.10
	192.168.1.11
	192.168.1.12
Server_X
	192.168.1.10
Server_Y
	192.168.1.11
Server_Z
	192.168.1.12
Servers
	192.168.1.10
	192.168.1.11
	192.168.1.12
EOF
$PARSEACL -O object_list.txt  > y-result-test
cmp x-result-test y-result-test || exit 1
rm x-result-test y-result-test
echo OK

exit 0
